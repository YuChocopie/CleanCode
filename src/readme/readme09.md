# 테스트

### TDD 장점과 단점

**장점**
- 높은 소스 코드 품질
- 재설계 비용 절감
- 쉬운 문서화
- 디버깅 시간 절감

**단점**
- 테스트 코드를 유지보수하는데 비용이 많이 들어간다.

### TDD 법칙 세 가지

- 첫째 법칙: 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
- 둘째 법칙: 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
- 셋째 법칙: 현재 실패하는 테스트를 통과할 징도로만 실제 코드를 작성한다.

### 깨끗한 테스트 코드 유지하기

- 지저분한 테스트 코드를 내놓으나 테스트를 안 하나 오십보 백보이다.
- 테스트 코드는 실재 코드 못지 않게 중요하다.

### 깨끗한 테스트 코드

**기능 별로 코드 정리 (build-operate-check 패턴)**

- Build : 테스트 자료를 만든다
- Operate : 테스트 자료를 조작한다.
- Check :조작한 결과가 올바른지 확인한다.

**도메인에 특화된 테스트 언어**

- 테스트를 구현하는 당사자와 나중에 테스트를 읽어볼 독자를 도와주는 테스트 언어다.

**이중표현**

- 테스트 API 코드에 적용하는 표준은 실제 코드에 적용하는 표준과 확실히 다르다.
- 단순하고, 간결하고, 표현력이 풍부해야 하지만, 실제 코드만큼 효율적일 필요는 없다.

### 테스트 당 assert 하나

- assert 문이 단 하나인 함수는 결론이 하나라서 코드를 이해하기 쉽고 빠르다.
- 함수 이름을 바꿔 give-when-then이라는 관례를 사용한다.

**give-when-then**

- Given 특정 사항
- When 테스트 하려는 특정 액션
- Then 변화된 상태나 수행되는 행동을 검증

```kotlin
@Test
fun 이메일로그인_실패케이스_잘몬된이메일형식입력() {

    //given - 잘못 된 이메일을 입력한다.

    //when - 이메일 로그인 버튼을 클릭한다.

    //then - 유효성 검증 실패 & 이메일 겅증 오류 메시지를 보여준다.
}
```
[Android TDD 적용기](https://www.youtube.com/watch?v=avcKY-_3gus)

- 템플릿 메소드 패턴을 사용하면 중복을 제거할 수 있다.(알고리즘의 일부 단계를 구현하는 것을 서브클래스에서 처리합니다.)
- assert 문을 여럿 사용하는 편이 좋을 떄고 있지만 최대한 줄여야한다.

**테스트 당 개념 하나**

- 테스트 함수마다 한 개념만 테스트하라

**종합**

- 개념 당 assert 문 수를 최소로 줄여라
- 테스트 함수 하나는 개념 하나만 테스트하라

### F.I.R.S.T

- Fast(빠르게) : 테스트는 빨라야 한.
- Independent(독립적으로) : 각 테스트는 서로 의존하면 안 된다.
- Repeatable(반복가능하게) : 테스트는 어떤 환경에서도 반복 가능해야 한다.
- Self-Validating(자가검증하는) : 테스트는 부울 값으로 결과를 내야 한다.
- Timely(적시에) : 테스트는 적시에 작성해야 한다.

### 결론

- 테스트 코드는 실제 코드만큼이나 프로젝트 건강에 중요하다.
- 테스트 코드는 지속적으로 깨끗하게 관리하자.
- 테스트 API를 구현해 도메인 특화 언어를 만들자







